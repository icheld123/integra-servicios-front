<div class="p-4 dashboard">

  <div class="bg-white m-auto border-2 border-gray-300 rounded-lg p-4 
              flex items-center justify-between gap-6 w-full max-w-7xl">

    <form [formGroup]="filter" class="mt-4">
      <mat-form-field>
        <mat-label>Tipo de recurso</mat-label>
        <mat-select formControlName="tipo">
          <mat-option value="">Todos</mat-option>
          <mat-option *ngFor="let tipo of tiposRecursos" [value]="tipo.tipo_recurso.id_tipo_recurso">{{tipo.tipo_recurso.nombre_tipo_recurso}}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field class="flex-1 m-2">
        <mat-label>Fecha de reserva:</mat-label>
        <input formControlName="fecha_inicio" matInput [matDatepicker]="pickerInicio">
        <mat-datepicker-toggle matIconSuffix [for]="pickerInicio"></mat-datepicker-toggle>
        <mat-datepicker #pickerInicio></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="field m-2" appearance="fill">
        <mat-label>Hora de inicio de reserva:</mat-label>
        <input matInput type="time" formControlName="hora_inicio">
      </mat-form-field>
      <mat-form-field class="field m-2" appearance="fill">
        <mat-label>Hora de fin de reserva:</mat-label>
        <input matInput type="time" formControlName="hora_fin">
      </mat-form-field>
      <mat-checkbox formControlName="disponibilidad_completa" class="example-margin">Disponibilidad estricta</mat-checkbox>
    </form>

    <div>
      <button [disabled]="filter.invalid" type="button" (click)="filterRecursos()"
              class="bg-red-700 p-2 text-white rounded-lg">
        Filtrar
      </button>
    </div>

  </div>

  <div class="mt-4 w-full m-auto">

    <div *ngIf="recursos.length==0" class="flex flex-col items-center justify-center gap-4 mt-8 text-white">
      <img src="assets/empty.svg" class="w-40" style="filter: invert(1);" alt="">
      <p>¡Llena los campos requeridos para cargar recursos!</p>
    </div>

    <div *ngIf="recursos.length>0"  class="flex flex-wrap justify-center gap-4">
      <div *ngFor="let recurso of recursos"
           class="w-full sm:w-1/2 md:w-1/3 lg:w-1/4 bg-white border border-gray-300 
                  rounded-lg p-4 flex flex-col items-center">

        <img class="w-40 h-40 mb-4 object-cover"
          [src]="recurso.foto_recurso 
            ? 'data:image/jpeg;base64,' + recurso.foto_recurso 
            : 'https://cdn.britannica.com/77/170477-050-1C747EE3/Laptop-computer.jpg'"
          alt="recurso">

        <p><strong>Nombre:</strong> {{recurso.nombre_recurso}}</p>
        <p><strong>Tipo:</strong> {{recurso.nombre_tipo}}</p>
        <p><strong>Unidad:</strong> {{recurso.nombre_unidad}}</p>
        <p><strong>Descripción:</strong> {{recurso.descripcion_recurso}}</p>
        
        <button (click)="abrirModal(recurso)"
                class="bg-red-300 hover:text-white text-black p-2 rounded-lg hover:bg-red-600 mt-4 shadow-md border border-red-400">
          Reservar
        </button>

      </div>
        <div class="flex justify-center items-center mt-6 gap-4">
          <button (click)="prevPage()"
                  [disabled]="page === 1"
                  class="px-4 py-2 bg-gray-200 rounded-lg disabled:opacity-50">
            Anterior
          </button>

          <span class="text-white text-lg font-semibold">
            Página {{page}}
          </span>

          <button (click)="nextPage()"
                  class="px-4 py-2 bg-gray-200 rounded-lg">
            Siguiente
          </button>
        </div>
    </div>

  </div>

</div>

<app-reserva-modal
  [abierto]="modalAbierto"
  [recurso]="recursoSeleccionado!"
  [horario]="horarioSeleccionado!"
  [horaInicio]="horaInicioSeleccionada"
  [horaFin]="horaFinSeleccionada"
  [fecha]="fechaSeleccionada!"
  (cerrar)="cerrarModal()">
</app-reserva-modal>






